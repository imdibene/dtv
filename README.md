# Development Tools Visualisers

This repository holds a small collection of tools that provide a graphical form of visualisation for different parts of your POSIX/POSIX-like system (currently only tested on MacOS and Linux).

## How to build the collection of tools

First you need to *build* the build system:

```shell
clang -o nob nob.c
```

and then use it to build the applications:

```shell
./nob
```

This will create the `build` directory where all the built artifacts are located. Now you can use them.

## Repository organization

```shell
./
├── LICENSE     # License (MIT)
├── README.md   # This page
├── build/      # Autogenerated at build-time
│   ├── dtv*    # device-tree-visualiser cli tool
│   └── ps2gv*  # process-tree-to-graph-visualiser cli tool
├── examples/                           # Render layouts examples
│   ├── am335x-bone__dot__layout.svg    # device-tree rendered with 'dot' layout engine
│   ├── am335x-bone__fdp__layout.svg    # device-tree rendered with 'fdp' layout engine
│   ├── process_tree_linux.svg          # process tree Linux target
│   ├── process_tree_macos.svg          # process tree MacOS target
│   ├── ps2gv.conf                      # ps2gv example config file
│   └── ptree-coloured.svg              # process tree coloured example
├── external/   # external static libraries and dependencies
│   └── nob.h   # Build system header
├── nob         # Build system
├── nob.c       # Build system sources
├── src/                # This project sources
│   ├── dtv.cc          # device-tree-visualiser source code
│   ├── ps2gv-config.cc # process-tree-to-graph-visualiser source code
│   ├── ps2gv-config.h  # process-tree-to-graph-visualiser source code
│   ├── ps2gv.cc        # process-tree-to-graph-visualiser source code
│   └── ps2gv.h         # process-tree-to-graph-visualiser source code
└── utils/              # Collection of utilities
    └── dependencies    # Check project dependencies
```

## dtv: Device Tree Visualiser

This small cli tool generates a graphical representation of a *device-tree-blob*. If you are like me, and have a monkey brain and need to see the pretty pictures to understand all those fancy words, this tool might help you to understand the relationships of the devices of your platform.


```shell
./dtv foo.dtb <render_engine: dot|fdp>

./dtv foo.dtb fdp
./dtv foo.dtb dot
```

This will create a `foo.svg` as output, now your device tree has a graphical representation.

### tl;dr

foo.dtb -> [ dtv : dot|fdp ] -> foo.svg

## ps2gv: Process Tree to Graph Visualiser

This cli tool is inspired by Brendan Gregg's [Colony Graphs](https://www.brendangregg.com/colonygraphs.html) scripts, this capture a snapshop of your system processes and their parent and child relationships.

the cli tool supports these usage patterns:

- Default config and `ps` command, output `ptree.svg`

```shell
./ps2gv
```

- Custom config location

```shell
./ps2gv -c ~/myconfig.conf
```

- Process single file

```shell
./ps2gv foo
```

- Process multiple files with default config

```shell
./ps2gv foo bar baz
```

- Process files with custom config

```shell
./ps2gv -c settings.conf log1.txt log2.txt
```

The input files can be generated:

- for Linux

```shell
ps -eo zone,ppid,pid,rss,pcpu,comm > ps-snapshot
```

- for MacOS

```shell
ps -eo ppid,pid,rss,pcpu,comm > ps-snapshot
```

### tl;dr

Usage: ./build/ps2gv [-c config_file] [input_files...]

## References

- [git kernel tree: Documentation/devicetree](https://web.git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/devicetree)
- [Website: https://www.devicetree.org](https://www.devicetree.org)
- [Video: Device Tree for Dummies! - Thomas Petazzoni, Free Electrons](https://youtu.be/m_NyYEBxfn8?si=gxfQnGGdv6R7iz1e)
- [Video: Device Tree: hardware description for everybody!](https://youtu.be/Nz6aBffv-Ek?si=vWhUn6WJIg9Tt-xT)
- [Colony Graphs](https://www.brendangregg.com/colonygraphs.html)
